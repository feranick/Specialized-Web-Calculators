<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wet-Bulb Temperature Calculator</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'indigo-700': '#4338ca',
                        'indigo-600': '#4f46e5',
                        'indigo-100': '#e0e7ff',
                        'indigo-200': '#c7d2fe',
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom styles for a modern look */
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f0f4f8 0%, #d9e2ec 100%);
        }

        /* Styling for the custom range input (slider) */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            height: 12px; /* Track height */
            background: #e0e7ff; /* Lighter track color */
            border-radius: 6px;
            margin: 10px 0;
            cursor: pointer;
        }

        /* Slider thumb (handle) */
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            height: 24px;
            width: 24px;
            background: #4f46e5; /* Thumb color */
            border-radius: 50%;
            border: 4px solid #fff;
            box-shadow: 0 0 4px rgba(0, 0, 0, 0.2);
            transition: background 0.15s ease-in-out;
        }

        input[type=range]::-webkit-slider-thumb:hover {
            background: #4338ca;
        }

        input[type=range]:focus {
            outline: none;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <div id="calculator-card" class="bg-white p-8 sm:p-10 rounded-xl shadow-2xl w-full max-w-lg border-t-4 border-indigo-600">

        <h1 class="text-3xl font-bold text-gray-900 mb-2">Wet-Bulb Temperature Estimator</h1>
        <p class="text-sm text-gray-500 mb-6">Adjust the sliders to see the estimated wet-bulb temperature ($T_w$) in real time using the Stull formula.</p>

        <!-- Input Fields -->
        <div class="space-y-8">

            <!-- Dry-Bulb Temperature Slider -->
            <div class="p-4 bg-indigo-50 rounded-lg shadow-inner">
                <label for="dryBulbTemp" class="block text-md font-bold text-gray-700 mb-2">
                    Air Temperature (T - Dry-Bulb)
                </label>
                <div class="flex justify-between items-center mb-1">
                    <span class="text-lg font-mono text-indigo-700 min-w-[5rem]" id="tempValue">25.0 °C</span>
                    <span class="text-sm text-gray-500">Range: -10 °C to 50 °C</span>
                </div>
                <input type="range" id="dryBulbTemp" min="-10" max="50" value="25" step="0.1"
                       oninput="updateDisplay(this.value, 'tempValue'); calculateWetBulb();">
            </div>

            <!-- Relative Humidity Slider -->
            <div class="p-4 bg-indigo-50 rounded-lg shadow-inner">
                <label for="relativeHumidity" class="block text-md font-bold text-gray-700 mb-2">
                    Relative Humidity (RH)
                </label>
                <div class="flex justify-between items-center mb-1">
                    <span class="text-lg font-mono text-indigo-700 min-w-[5rem]" id="rhValue">60 %</span>
                    <span class="text-sm text-gray-500">Range: 5% to 100%</span>
                </div>
                <input type="range" id="relativeHumidity" min="5" max="100" value="60" step="1"
                       oninput="updateDisplay(this.value, 'rhValue'); calculateWetBulb();">
            </div>
        </div>

        <!-- Result Display -->
        <div class="mt-8 text-center bg-indigo-600 text-white p-6 rounded-xl shadow-lg border-b-8 border-indigo-700">
            <h2 class="text-md font-semibold mb-2 uppercase tracking-wider">Estimated Wet-Bulb Temperature ($T_w$)</h2>
            <p id="result" class="text-5xl font-extrabold flex items-center justify-center transition-colors duration-300">
                <!-- Result will appear here -->
            </p>
            <p id="alert-message" class="text-xs text-indigo-200 mt-2 h-4"></p>
        </div>

    </div>

    <script>
        // Use a unique ID based on crypto.randomUUID for better practice in larger apps
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        /**
         * Updates the numerical display next to the slider.
         * @param {string} value The current value of the slider.
         * @param {string} id The ID of the element to update.
         */
        function updateDisplay(value, id) {
            const unit = (id === 'tempValue') ? ' °C' : ' %';
            document.getElementById(id).textContent = value + unit;
        }

        /**
         * Calculates the Wet-Bulb Temperature (Tw) in Celsius using the Stull empirical formula.
         */
        function calculateWetBulb() {
            const T = parseFloat(document.getElementById('dryBulbTemp').value); // Dry-Bulb Temp (C)
            const RH = parseFloat(document.getElementById('relativeHumidity').value); // Relative Humidity (%)
            const resultElement = document.getElementById('result');
            const alertMessageElement = document.getElementById('alert-message');

            // Clear previous message
            alertMessageElement.textContent = '';
            
            // The Stull formula is an approximation, but it's a closed-form solution.
            // It is designed for RH between 5% and 99% and T between -20°C and 50°C.
            
            // Formula Terms: Tw = T * atan[...] + atan(T+RH) - atan(RH-1.676...) + 0.0039... * RH^1.5 * atan(...) - 4.686...
            
            let term1 = T * Math.atan(0.151977 * Math.sqrt(RH + 8.313659));
            let term2 = Math.atan(T + RH);
            let term3 = Math.atan(RH - 1.676331);
            let term4 = 0.00391838 * Math.pow(RH, 1.5) * Math.atan(0.023101 * RH);
            let term5 = 4.686035;

            let Tw = term1 + term2 - term3 + term4 - term5;

            // Optional alert for near-critical conditions (human heat stress threshold is ~35°C)
            if (Tw >= 31 && T >= 30) {
                 alertMessageElement.textContent = 'WARNING: Conditions approach human survival limits.';
            } else if (Tw < 0) {
                 alertMessageElement.textContent = 'Frost point calculation is complex. This is an estimate.';
            }

            // --- Display Result ---
            resultElement.innerHTML = `${Tw.toFixed(2)} <span class="text-3xl">&deg;C</span>`;
        }

        // --- Initialization ---
        window.onload = function() {
            // Update the display with initial values
            updateDisplay(document.getElementById('dryBulbTemp').value, 'tempValue');
            updateDisplay(document.getElementById('relativeHumidity').value, 'rhValue');

            // Run the calculation immediately on load
            calculateWetBulb();
        };

    </script>
</body>
</html>
